%PA calibration global background
%2	100	1258.357143	944.5017007;...
%mmax = 40000 for kVp=39, 7000 for 26kVp
%{
2	0	10574.77543	11351.84995;...
2	30	12515.53467	12766.2137;...
2	45	13472.69974	13452.20248;...
2	50	13857.0306	13700.45956;...
2	60	14613.89958	14208.31416;...
2	70	15214.14309	14616.28952;...
2	100	17357.11108	16114.05303;...
%}
Data=[...
3	0	16341.39173	15718.57281;...
3	30	19026.3896	17497.03203;...
3	45	20328.8627	18346.38205;...
3	50	20854.67733	18648.31683;...
3	60	21932.25858	19314.25679;...
3	70	22812.91225	19844.0881;...
3	100	25795.77718	21678.47951;...
4	0	22380.4199	20109.97126;...
4	30	25789.54624	22061.18261;...
4	45	27397.98607	22994.47925;...
4	50	28029.49384	23338.56049;...
4	60	29401.53824	24132.8842;...
4	70	30516.7688	24773.52162;...
4	100	34200.94664	26783.4155;...
5	0	27628.75665	24179.11109;...
5	30	31530.84515	26486.20198;...
5	45	33339.15071	27443.51977;...
5	50	34052.67798	27845.35922;...
5	60	35641.33198	28765.70702;...
5	70	36940.71292	29537.33278;...
5	100	41281.28489	31904.91489;...
];

Data(:,3)=Data(:,3)/1000;
Data(:,4)=Data(:,4)/1000;
Data(:,3)=Data(:,3)./Data(:,4);
B=[Data(:,1) Data(:,2)];
A=[ones(size(Data,1),1) Data(:,3) Data(:,4) Data(:,3).^2 Data(:,4).^2 Data(:,3).*Data(:,4)];
X=A\B

Result=A*X
figure;plot(Result(:,2),'o');hold on;
plot(Data(:,2),'rx');

dev_thickness = (sum((Data(:,1)-Result(:,1)).^2)./size(Data,1)).^0.5
dev_density = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5
%dev = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5



