%PA calibration global background
%2	100	1258.357143	944.5017007;...
%mmax = 40000 for kVp=39, 7000 for 26kVp
%{
2	0	13167.46495	11559.48077;...
2	30	15109.0784	12976.69183;...
2	45	16066.74843	13660.77852;...
2	50	16451.52215	13921.96648;...
2	60	17207.2346	14426.76265;...
2	70	17807.57465	14827.50621;...
2	100	19952.93197	16299.36598;...
%}
Data=[...
3	0	18935.18776	15927.41892;...
3	30	21620.59786	17714.39016;...
3	45	22922.72769	18553.15243;...
3	50	23449.78347	18884.19927;...
3	60	24529.99101	19533.63939;...
3	70	25408.83702	20062.7299;...
3	100	28393.84024	21847.87992;...
4	0	24976.91856	20332.22149;...
4	30	28384.50143	22330.81888;...
4	45	29993.32787	23260.53367;...
4	50	30624.70775	23653.39881;...
4	60	31996.82716	24448.65316;...
4	70	33112.08226	25077.29861;...
4	100	36795.45884	27031.9492;...
5	0	30222.67546	24315.39383;...
5	30	34124.09963	26616.67341;...
5	45	35931.96956	27629.52939;...
5	50	36644.66027	28049.2181;...
5	60	38237.47492	28928.1907;...
5	70	39533.45414	29646.91567;...
5	100	43877.0383	31914.21335;...
];

Data(:,3)=Data(:,3)/1000;
Data(:,4)=Data(:,4)/1000;
Data(:,3)=Data(:,3)./Data(:,4);
B=[Data(:,1) Data(:,2)];
A=[ones(size(Data,1),1) Data(:,3) Data(:,4) Data(:,3).^2 Data(:,4).^2 Data(:,3).*Data(:,4)];
X=A\B

Result=A*X
figure;plot(Result(:,2),'o');hold on;
plot(Data(:,2),'rx');

dev_thickness = (sum((Data(:,1)-Result(:,1)).^2)./size(Data,1)).^0.5
dev_density = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5
%dev = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5



