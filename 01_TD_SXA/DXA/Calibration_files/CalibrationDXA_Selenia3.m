%PA calibration global background
%2	100	1258.357143	944.5017007;...
%mmax = 60000 for kVp=39
%{
2	0	13172.33781	15340.26283;...
2	30	15113.24327	16752.65593;...
2	45	16066.99738	17429.26132;...
2	50	16452.58538	17676.90253;...
2	60	17210.66255	18194.95276;...
2	70	17809.09231	18597.82443;...
2	100	19952.02128	20101.21493;...
%}

Data=[...
3	0	18936.89387	19706.01696;...
3	30	21622.54519	21472.42275;...
3	45	22924.91483	22313.76209;...
3	50	23449.72379	22616.09488;...
3	60	24527.15989	23285.58219;...
3	70	25408.04514	23814.94128;...
3	100	28389.26356	25647.87055;...
4	0	24975.95118	24091.22113;...
4	30	28384.55449	26043.78576;...
4	45	29994.64871	26976.75279;...
4	50	30623.4264	27319.31229;...
4	60	31996.54961	28116.85196;...
4	70	33111.6198	28757.17849;...
4	100	36798.88875	30768.45671;...
5	0	30224.27867	28162.87979;...
5	30	34126.95741	30467.7111;...
5	45	35934.93388	31427.04993;...
5	50	36649.30711	31822.78395;...
5	60	38238.34746	32739.53565;...
5	70	39535.95718	33495.62968;...
5	100	43881.90689	35862.65338;...
];

Data(:,3)=Data(:,3)/1000;
Data(:,4)=Data(:,4)/1000;
Data(:,3)=Data(:,3)./Data(:,4);
B=[Data(:,1) Data(:,2)];
A=[ones(size(Data,1),1) Data(:,3) Data(:,4) Data(:,3).^2 Data(:,4).^2 Data(:,3).*Data(:,4)];
X=A\B

Result=A*X
figure;plot(Result(:,2),'o');hold on;
plot(Data(:,2),'rx');

dev_thickness = (sum((Data(:,1)-Result(:,1)).^2)./size(Data,1)).^0.5
dev_density = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5
%dev = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5



