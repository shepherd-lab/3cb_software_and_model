%PA calibration global background
%2	100	1258.357143	944.5017007;...
%mmax = 40000 for kVp=39,  [5 5] median filter
%{
2	1.35	13168.52459	11354.40028
2	29.75	15110.30631	12769.56348
2	43.5	16065.64167	13451.33716
2	49.1	16451.71254	13701.79529
2	60.53	17207.39914	14211.64354
2	69.85	17807.63883	14616.97336
2	101.4	19951.97482	16117.87807
%}
Data=[...
2.96	1.35	18933.50357	15723.61029
2.96	29.75	21617.61982	17485.31041
2.96	43.5	22919.00669	18323.64402
2.96	49.1	23448.59117	18628.92633
2.96	60.53	24529.87476	19295.27214
2.96	69.85	25412.1347	19826.12705
2.96	101.4	28399.14472	21656.99654
4	1.35	24975.5472	20102.15636
4	29.75	28385.15721	22060.54727
4	43.5	29994.05043	22992.23388
4	49.1	30625.36127	23335.64076
4	60.53	31996.11383	24139.53309
4	69.85	33111.1562	24772.25924
4	101.4	36794.99124	26788.58438
4.96	1.35	30222.22965	24175.11483
4.96	29.75	34123.13197	26479.6453
4.96	43.5	35930.76161	27434.5003
4.96	49.1	36644.66897	27839.31649
4.96	60.53	38239.12843	28763.55513
4.96	69.85	39533.87355	29527.60771
4.96	101.4	43881.39594	31882.16277
];

Data(:,3)=Data(:,3)/1000;
Data(:,4)=Data(:,4)/1000;
Data(:,3)=Data(:,3)./Data(:,4);
B=[Data(:,1) Data(:,2)];
A=[ones(size(Data,1),1) Data(:,3) Data(:,4) Data(:,3).^2 Data(:,4).^2 Data(:,3).*Data(:,4)];
X=A\B

Result=A*X
figure;plot(Result(:,2),'o');hold on;
plot(Data(:,2),'rx');

dev_thickness = (sum((Data(:,1)-Result(:,1)).^2)./size(Data,1)).^0.5
dev_density = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5
%dev = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5



