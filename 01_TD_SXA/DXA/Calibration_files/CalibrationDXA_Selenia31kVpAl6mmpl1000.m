%PA calibration global background
%2	100	1258.357143	944.5017007;...
%mmax = 40000 for kVp=39,  [5 5] median filter 
%{
%}
Data=[...
7	100	49036.8112	32562.88201
7	70	45533.11719	31024.27878
7	60	44416.43008	30460.80877
7	50	43015.24812	29854.81561
7	45	42299.95571	29575.78828
7	30	40647.72433	29099.40947
7	0	36938.99042	28057.0875
6	100	44205.34974	29938.76406
6	70	40858.80588	28562.30464
6	60	39798.89873	28056.65775
6	50	38478.37251	27542.81108
6	45	37826.44572	27302.83278
6	30	36235.28862	26862.82604
6	0	32771.96904	25914.42591
5	100	38335.30945	26906.05795
5	70	35193.58397	25701.02024
5	60	34243.3247	25285.6
5	50	33025.74273	24836.13689
5	45	32419.95851	24623.22001
5	30	30985.78488	24266.60634
5	0	27858.37222	23424.89465
4	100	32550.8309	24109.08684
4	70	29687.8978	23108.98664
4	60	28845.44435	22780.38568
4	50	27781.48269	22422.94342
4	45	27257.41768	22249.21024
4	30	25963.15776	21944.14943
4	0	23188.32762	21205.22554
];

Data(:,3)=Data(:,3)/1000;
%temp = Data(:,3);
Data(:,4)=Data(:,4)/1000;
Data(:,3)=Data(:,3)./Data(:,4);
%Data(:,4) = temp;
B=[Data(:,1) Data(:,2)];
A=[ones(size(Data,1),1) Data(:,3) Data(:,4) Data(:,3).^2 Data(:,4).^2 Data(:,3).*Data(:,4)  ];%Data(:,3).^3 Data(:,4).^3
X=A\B
Result=A*X;
figure;plot(Result(:,2),'o');hold on;
plot(Data(:,2),'rx');

dev_thickness = (sum((Data(:,1)-Result(:,1)).^2)./size(Data,1)).^0.5
dev_density = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5
x = X;
d = 1;
%dev = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5
;



