%PA calibration global background
%2	100	1258.357143	944.5017007;...
%mmax = 40000 for kVp=39,  [5 5] median filter 
%{
0.95	0	6467.971869	3129.358222
0.95	30	7574.228279	3464.368433
0.95	45	8116.786677	3621.239115
0.95	50	8329.045969	3689.95585
0.95	60	8735.143002	3814.124685
0.95	70	9037.995348	3921.212446
0.95	100	10177.86456	4291.642667
6	100	52925.04428	22251.91171
6	70	48217.30987	20585.43912
6	60	46665.59567	19993.00735
6	50	44815.26532	19389.45938
6	45	44038.5224	19075.92531
6	30	42007.82555	18555.50349
6	0	37415.04486	17347.01121
%}
Data=[...
2	0	13638.30231	6288.33379
2	30	15681.89018	6892.011983
2	45	16663.34357	7151.679442
2	50	17090.55094	7300.752939
2	60	17861.87517	7540.592084
2	70	18512.31769	7764.670065
2	100	20773.12488	8474.337985
2.95	0	19793.91518	9034.905523
2.95	30	22556.54132	9860.113397
2.95	45	23907.63548	10218.311
2.95	50	24438.86839	10395.59823
2.95	60	25531.64491	10749.94756
2.95	70	26442.69792	11057.84534
2.95	100	29544.77031	12064.60034
4	0	26005.50816	11900.90897
4	30	29507.20128	12877.62572
4	45	31151.24995	13321.22519
4	50	31820.64269	13538.24153
4	60	33226.76431	14025.91805
4	70	34373.19	14413.4929
4	100	38223.80824	15678.24696
4.95	100	45607.01643	18830.14944
4.95	70	41222.56818	17411.85721
4.95	60	39874.11302	16928.05055
4.95	50	38233.02919	16402.7932
4.95	45	37475.22432	16145.33226
4.95	30	35571.41274	15654.40059
4.95	0	31473.07599	14549.82914
];

Data(:,3)=Data(:,3)/1000;
%temp = Data(:,3);
Data(:,4)=Data(:,4)/1000;
Data(:,3)=Data(:,3)./Data(:,4);
%Data(:,4) = temp;
B=[Data(:,1) Data(:,2)];
A=[ones(size(Data,1),1) Data(:,3) Data(:,4) Data(:,3).^2 Data(:,4).^2 Data(:,3).*Data(:,4)];
X=A\B
Result=A*X;
figure;plot(Result(:,2),'o');hold on;
plot(Data(:,2),'rx');

dev_thickness = (sum((Data(:,1)-Result(:,1)).^2)./size(Data,1)).^0.5
dev_density = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5
d = 1;
%dev = (sum((Data(:,2)-Result(:,2)).^2)./size(Data,1)).^0.5
;



